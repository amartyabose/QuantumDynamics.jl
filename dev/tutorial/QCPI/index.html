<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum-Classical Path Integral · QuantumDynamics.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">QuantumDynamics.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../EmpiricalApproaches/">Empirical Approaches</a></li><li><a class="tocitem" href="../BasicPI/">Path Integrals</a></li><li><a class="tocitem" href="../Bloch-Redfield/">Bloch-Redfield Master Equation</a></li><li class="is-active"><a class="tocitem" href>Quantum-Classical Path Integral</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../ExternalFieldDynamics/">Dynamics under External Fields</a></li><li><a class="tocitem" href="../HEOM/">Hierarchical Equations of Motion</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../../documentation/Bare/">Bare System Propagation</a></li><li><a class="tocitem" href="../../documentation/SpectralDensities/">Spectral Densities</a></li><li><a class="tocitem" href="../../documentation/BlochRedfield/">Bloch-Redfield Master Equation</a></li><li><a class="tocitem" href="../../documentation/EtaCoefficients/">Eta Coefficients</a></li><li><a class="tocitem" href="../../documentation/QuAPI/">Quasi-Adiabatic Propagator Path Integral</a></li><li><a class="tocitem" href="../../documentation/Blip/">Blip Decomposition</a></li><li><a class="tocitem" href="../../documentation/QCPI/">Quantum-Classical Path Integral</a></li><li><a class="tocitem" href="../../documentation/TEMPO/">Time-Evolving Matrix Product Operators</a></li><li><a class="tocitem" href="../../documentation/PCTNPI/">Pairwise-Connected Tensor Network Path Integral</a></li><li><a class="tocitem" href="../../documentation/TTM/">Transfer Tensor Method</a></li><li><a class="tocitem" href="../../documentation/HEOM/">Hierarchical Equations of Motion</a></li><li><a class="tocitem" href="../../documentation/Utilities/">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Quantum-Classical Path Integral</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quantum-Classical Path Integral</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/amartyabose/QuantumDynamics.jl/blob/main/docs/src/tutorial/QCPI.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quantum-Classical-Path-Integral-(QCPI)"><a class="docs-heading-anchor" href="#Quantum-Classical-Path-Integral-(QCPI)">Quantum-Classical Path Integral (QCPI)</a><a id="Quantum-Classical-Path-Integral-(QCPI)-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Classical-Path-Integral-(QCPI)" title="Permalink"></a></h1><p>QCPI is a numerically exact method for simulating a quantum system interacting with a large thermal environment. This environment is described through force-fields or <em>ab initio</em> molecular dynamics trajectories. While the Gaussian response results are often very good, it is an exciting prospect to be able to solve the full atomistic problem. Here, we implement the harmonic-backreaction (HBR) version of QCPI, which charts a middle-ground between the solution to the fully atomistic problem and the fully harmonic problem. In HBR, the full anharmonicity of the solvent is taken into account in the classical temperature-dependent part of the memory. The quantum, temperature-independent part of the memory is dealt with harmonically.</p><p>In QuantumDynamics.jl, QCPI is a wrapper around other base path integral methods like QuAPI, TNPI, or Blips. So, we automatically get standard HBR-QCPI (a combination QCPI with QuAPI), blip HBR-QCPI (a combination of QCPI with blips) and HBR-TNPI (a combination of QCPI with TNPI) based on the &quot;backend&quot; used.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>The basic simulation starts in a manner that should familiar from the setup of a QuAPI or TNPI simulation.</p><pre><code class="language-julia hljs">using QuantumDynamics
using Plots, LaTeXStrings

H0 = Utilities.create_tls_hamiltonian(; ϵ=2.0, Δ=2.0)        # 1.1 Define the system Hamiltonian
ρ0 = [1.0+0.0im 0.0; 0.0 0.0]
β = 5.0
dt = 0.25
ntimes = 100
nothing</code></pre><p>Right now QCPI only supports harmonic solvents, but it is possible to code up generic atomistic solvents or simply provide adapters for packages like Molly.jl or DFTK.jl. So, let&#39;s define the harmonic bath and discretize it into 100 oscillators for the classical trajectories.</p><pre><code class="language-julia hljs">Jw = SpectralDensities.ExponentialCutoff(; ξ=0.1, ωc=7.5)    # 1.2 Define the spectral density
ω, c = SpectralDensities.discretize(Jw, 100)
hb = Solvents.HarmonicBath(β, ω, c, [1.0, -1.0], 1000);
nothing</code></pre><p><code>SpectralDensities.discretize</code> discretizes a given spectral density into oscillators. Then we create a <code>Solvents.HarmonicBath</code> bath at the given inverse temperature, with the frequencies and couplings. The last two arguments to <code>Solvents.HarmonicBath</code> are the system operator along which the solvent acts and the number of initial conditions that would be sampled. How the solvent samples the phase-space is dependent on the particular implementation. For a harmonic bath, one can simply sample the multidimensional Gaussian distributions. For molecular solvents, one can implement molecular dynamics trajectories with a thermostat.</p><p>One can generate the ensemble averaged classical path result, which contains only the real part of memory. This involves generating the correct propagators and using them to propagate an initial reduced density matrix.</p><pre><code class="language-julia hljs">EACP_fbU = Propagators.calculate_average_reference_propagators(; Hamiltonian=H0, solvent=hb, classical_dt=dt/100, dt, ntimes);
times_EACP, ρs_EACP = Utilities.apply_propagator(; propagators=EACP_fbU, ρ0, ntimes, dt);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.0:0.25:25.0, ComplexF64[1.0 + 0.0im 0.0 + 0.0im; 0.942050578263835 + 0.0im -0.0519022015968072 + 0.21685698697621475im; … ; 0.48767283856469007 + 5.482300151727915e-18im -0.0010349229384777516 - 0.0012225116802316862im; 0.49453044595931417 + 5.268048721934029e-18im 0.00839090906355273 - 0.0030739521118207653im]

ComplexF64[0.0 + 0.0im 0.0 + 0.0im; -0.0519022015968072 - 0.21685698697621475im 0.057949421736164325 + 0.0im; … ; -0.0010349229384777677 + 0.0012225116802316853im 0.5123271614353113 - 4.7004447183522665e-18im; 0.008390909063552745 + 0.0030739521118207623im 0.5054695540406867 - 3.855509672008041e-18im])</code></pre><p>For a full QCPI calculation, we use the <code>propagate</code> interface:</p><pre><code class="language-julia hljs">times_QCPI, ρs_QCPI = QCPI.propagate(; Hamiltonian=H0, Jw, solvent=hb, ρ0, classical_dt=dt/100, dt, ntimes, kmax=3, extraargs=QuAPI.QuAPIArgs(), path_integral_routine=QuAPI.propagate)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.0:0.25:25.0, ComplexF64[1.0 + 0.0im 0.0 + 0.0im; 0.9422572599533726 + 0.0im -0.039633568986224416 + 0.21886368375343165im; … ; 0.14313256475623864 - 1.0301019519923361e-17im 0.2930249996144609 - 0.022380041680856267im; 0.1480441126014308 - 9.653731253334287e-18im 0.30545778987568317 + 0.0069263134579775135im]

ComplexF64[0.0 + 0.0im 0.0 + 0.0im; -0.039633568986224416 - 0.21886368375343165im 0.0577427400466274 + 0.0im; … ; 0.293024999614461 + 0.022380041680856284im 0.8568674352437612 - 5.102818995134367e-18im; 0.3054577898756833 - 0.006926313457977517im 0.8519558873985693 + 3.280231970728118e-18im])</code></pre><p>Lastly, we run a TTM-QuAPI simulation for comparison and plot the results.</p><pre><code class="language- hljs">fbU = Propagators.calculate_bare_propagators(; Hamiltonian=H0, dt, ntimes);
@time times, ρs = TTM.propagate(; fbU=fbU, Jw=[Jw], β, ρ0, dt, ntimes, rmax=9, extraargs=Blip.BlipArgs(), path_integral_routine=Blip.build_augmented_propagator_QuAPI_TTM)
plot(times, real.(ρs[:,1,1] .- ρs[:,2,2]), ylim=(-1,1), xlim=(0,25), label=&quot;QuAPI&quot;)
plot!(times_EACP, real.(ρs_EACP[:,1,1] .- ρs_EACP[:,2,2]), label=&quot;EACP&quot;)
plot!(times_QCPI, real.(ρs_QCPI[:,1,1] .- ρs_QCPI[:,2,2]), label=&quot;QCPI&quot;)
xlabel!(L&quot;t&quot;)
ylabel!(L&quot;\langle\sigma_z(t)\rangle&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Bloch-Redfield/">« Bloch-Redfield Master Equation</a><a class="docs-footer-nextpage" href="../ExternalFieldDynamics/">Dynamics under External Fields »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 8 March 2023 15:01">Wednesday 8 March 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
